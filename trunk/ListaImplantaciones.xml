<?xml version="1.0" encoding="UTF-8"?>
<Module>
	<ModulePrefs title="Url implantations"
		description=""
		author_affiliation="Capgemini">
		<Require feature="idi"/>
		<Require feature="locked-domain" />
	</ModulePrefs>
	
	<UserPref name="_table_query_url" default_value="" display_name="Data source url (Ej:https://docs.google.com/spreadsheet/ccc?key=0AoYEewut2JmZdG5HM2VLTTdwQUlLdmhnMk1DLXBWZl)" required="true" />

	<Content type="html">
		<![CDATA[

		<script src="https://www.google.com/jsapi" type="text/javascript"></script>

		<style type="text/css">			 
			.mes{
			float:left;
			color: #0B5394;
			width:300px;
			font-size:16px;
			font-weight:bold;
			margin-bottom: 15px;
			}
			.mes li{
			color: black;
			color: black;
			text-decoration:underline;
			font-size:14px;
			margin:15px 15px;
			font-weight:normal;
			}
			.mes a{
			color: black;
			text-decoration:underline;
			font-size:14px;
			font-weight:normal;
			}
		</style>
		
					

		<!--<div id="urlimplantation"></div>-->
		<div style="width=100px">
		<!--<div id="Enero" class="mes">Enero</div>
		<div id="Febrero" class="mes">Febrero</div>
		<div id="Marzo" class="mes">Marzo</div>
		<div id="Abril" class="mes">Abril</div>
		<div id="Mayo" class="mes">Mayo</div>
		<div id="Junio" class="mes">Junio</div>
		<div id="Julio" class="mes">Julio</div>
		<div id="Agosto" class="mes">Agosto</div>-->
		<div id="Septiembre" class="mes">Septiembre</div><br/>
		<div id="Octubre" class="mes">Octubre</div><br/>
		<div id="Noviembre" class="mes">Noviembre</div><br/>
		<div id="Diciembre" class="mes">Diciembre</div><br/>
		</div>
		<script type="text/javascript"> 
			
			
			
			var gadgetHelper = null;	
			var prefs = new _IG_Prefs(); // User preferences			
			var urlTable = prefs.getString("_table_query_url");					
			
			_IG_RegisterOnloadHandler(loadVisualizationAPI);
			
			function loadVisualizationAPI() 
			{
				google.load("visualization", "1", {"packages": ["table"]});
				google.setOnLoadCallback(sendQuery);
			}

			function sendQuery() 
			{
				gadgetHelper = new google.visualization.GadgetHelper();
				var opts = {dataType:'jsonp'};				
				var query = new google.visualization.Query(urlTable, opts);							
				var querytosend = "select I,max(V)  where V <> '' group by I";
				query.setQuery(querytosend);			  
				query.send(handleQueryResponse);
				
			}

			
			function handleQueryResponse(response) 
			{
				if (!gadgetHelper.validateResponse(response)) 
				{ 
					return; 
				}
			
				data = response.getDataTable();		
				
				if(data.getNumberOfRows()!=0){
				var html = "";
				//html += "<ul>";
				
					for(var i=0; i<data.getNumberOfRows(); i++){
						var fecha = data.getValue(i,0);
						var mes = fecha[3]+fecha[4];
						switch(mes){
						case '01': document.getElementById('Enero').innerHTML += '<li><a  href="'+data.getValue(i,1)+'">' +fecha+ '</a></li>';break;
						case '02': document.getElementById('Febrero').innerHTML += '<li><a  href="'+data.getValue(i,1)+'">' +fecha+ '</a></li>';break;
						case '03': document.getElementById('Marzo').innerHTML += '<li><a  href="'+data.getValue(i,1)+'">' +fecha+ '</a></li>';break;
						case '04': document.getElementById('Abril').innerHTML += '<li><a  href="'+data.getValue(i,1)+'">' +fecha+ '</a></li>';break;
						case '05': document.getElementById('Mayo').innerHTML += '<li><a  href="'+data.getValue(i,1)+'">' +fecha+ '</a></li>';break;
						case '06': document.getElementById('Junio').innerHTML += '<li><a  href="'+data.getValue(i,1)+'">' +fecha+ '</a></li>';break;
						case '07': document.getElementById('Julio').innerHTML += '<li><a  href="'+data.getValue(i,1)+'">' +fecha+ '</a></li>';break;
						case '08': document.getElementById('Agosto').innerHTML += '<li><a  href="'+data.getValue(i,1)+'">' +fecha+ '</a></li>';break;
						case '09': document.getElementById('Septiembre').innerHTML += '<li><a  href="'+data.getValue(i,1)+'">' +fecha+ '</a></li>';break;
						case '10': document.getElementById('Octubre').innerHTML += '<li><a  href="'+data.getValue(i,1)+'">' +fecha+ '</a></li>';break;
						case '11': document.getElementById('Noviembre').innerHTML += '<li><a  href="'+data.getValue(i,1)+'">' +fecha+ '</a></li>';break;
						case '12': document.getElementById('Diciembre').innerHTML += '<li><a  href="'+data.getValue(i,1)+'">' +fecha+ '</a></li>';break;
						}
					//	html += '<li><a  href="'+data.getValue(i,1)+'">Implantaci&oacute;n del Cliente '+data.getValue(i,0)+' a fecha del ' +fecha+'</a></li>';
						
					
					}
				//html +=	"</ul>";
				//document.getElementById('urlimplantation').innerHTML = html;
			}
		}
		</script>
		]]>
	</Content>
</Module>